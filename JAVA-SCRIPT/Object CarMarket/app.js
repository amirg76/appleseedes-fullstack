const carMarket = {
  sellers: [
    {
      agencyName: "Best Deal",
      cash: 1245000,
      credit: 200000,
      agencyId: "Plyq5M5AZ",
      cars: [
        {
          brand: "bmw",
          models: [
            {
              name: "3",
              year: 2015,
              price: 137000,
              carNumber: "AZJZ4",
              ownerId: "Plyq5M5AZ",
            },
            {
              name: "X6",
              year: 2020,
              price: 966500,
              carNumber: "S6DL1",
              ownerId: "Plyq5M5AZ",
            },
          ],
        },
        {
          brand: "toyota",
          models: [
            {
              name: "Land Cruiser",
              year: 2020,
              price: 336300,
              carNumber: "6rvXw",
              ownerId: "Plyq5M5AZ",
            },
            {
              name: "Hilux",
              year: 2005,
              price: 35005,
              carNumber: "MWXBG",
              ownerId: "Plyq5M5AZ",
            },
            {
              name: "Corolla",
              year: 2020,
              price: 111900,
              carNumber: "hCzl-",
              ownerId: "Plyq5M5AZ",
            },
          ],
        },
        {
          brand: "Ford",
          models: [
            {
              name: "Focus",
              year: 2020,
              price: 98200,
              carNumber: "kN3HP",
              ownerId: "Plyq5M5AZ",
            },
            {
              name: "Focus",
              year: 2005,
              price: 6502,
              carNumber: "LJTCs",
              ownerId: "Plyq5M5AZ",
            },
          ],
        },
        {
          brand: "Alpha romeo",
          models: [
            {
              name: "Romeo Julia",
              year: 2020,
              price: 275406,
              carNumber: "2kjy7",
              ownerId: "Plyq5M5AZ",
            },
            {
              name: "Romeo Stelvio",
              year: 2019,
              price: 215403,
              carNumber: "7A5b-",
              ownerId: "Plyq5M5AZ",
            },
          ],
        },
        {
          brand: "Chevrolet",
          models: [
            {
              name: "Traverse",
              year: 2020,
              price: 201102,
              carNumber: "QwBOT",
              ownerId: "Plyq5M5AZ",
            },
            {
              name: "Impala",
              year: 2019,
              price: 165041,
              carNumber: "2v4jt",
              ownerId: "Plyq5M5AZ",
            },
            {
              name: "Malibu",
              year: 2017,
              price: 75405,
              carNumber: "O4_Jv",
              ownerId: "Plyq5M5AZ",
            },
          ],
        },
      ],
    },
    {
      agencyName: "CarMax",
      cash: 968541,
      credit: 500000,
      agencyId: "26_IPfHU1",
      cars: [
        {
          brand: "bmw",
          models: [
            {
              name: "X5",
              year: 2015,
              price: 218000,
              carNumber: "4Ixb0",
              ownerId: "26_IPfHU1",
            },
            {
              name: "X6",
              year: 2014,
              price: 97100,
              carNumber: "kAnv-",
              ownerId: "26_IPfHU1",
            },
            {
              name: "Z4",
              year: 2019,
              price: 296900,
              carNumber: "ISMdU",
              ownerId: "26_IPfHU1",
            },
            {
              name: "3",
              year: 2010,
              price: 75100,
              carNumber: "9DJPw",
              ownerId: "26_IPfHU1",
            },
          ],
        },
        {
          brand: "toyota",
          models: [
            {
              name: "Land Cruiser",
              year: 2005,
              price: 80540,
              carNumber: "Kt-pW",
              ownerId: "26_IPfHU1",
            },
            {
              name: "Corolla",
              year: 2019,
              price: 109100,
              carNumber: "YiYdI",
              ownerId: "26_IPfHU1",
            },
            {
              name: "Hilux",
              year: 2019,
              price: 204000,
              carNumber: "DRmNw",
              ownerId: "26_IPfHU1",
            },
          ],
        },
        {
          brand: "Ford",
          models: [
            {
              name: "F250",
              year: 2020,
              price: 198500,
              carNumber: "g4Wfp",
              ownerId: "26_IPfHU1",
            },
            {
              name: "Explorer",
              year: 2020,
              price: 265200,
              carNumber: "iNT8Q",
              ownerId: "26_IPfHU1",
            },
          ],
        },
        {
          brand: "Alpha romeo",
          models: [
            {
              name: "Spider",
              year: 2011,
              price: 75405,
              carNumber: "6t7QU",
              ownerId: "26_IPfHU1",
            },
            {
              name: "166",
              year: 2002,
              price: 12400,
              carNumber: "XMqpn",
              ownerId: "26_IPfHU1",
            },
          ],
        },
        {
          brand: "Chevrolet",
          models: [
            {
              name: "Impala",
              year: 2016,
              price: 65042,
              carNumber: "vbeAo",
              ownerId: "26_IPfHU1",
            },
            {
              name: "Savannah",
              year: 2016,
              price: 76505,
              carNumber: "WelWa",
              ownerId: "26_IPfHU1",
            },
          ],
        },
      ],
    },
    {
      agencyName: "The Auto World",
      cash: 687450,
      credit: 200000,
      agencyId: "gNHjNFL12",
      cars: [
        {
          brand: "bmw",
          models: [
            {
              name: "X6",
              year: 2018,
              price: 548100,
              carNumber: "EMW_7",
              ownerId: "gNHjNFL12",
            },
            {
              name: "3",
              year: 2017,
              price: 178000,
              carNumber: "XlnB4",
              ownerId: "gNHjNFL12",
            },
          ],
        },
        {
          brand: "toyota",
          models: [
            {
              name: "Prius",
              year: 2017,
              price: 101542,
              carNumber: "-RQgN",
              ownerId: "gNHjNFL12",
            },
            {
              name: "Highlander",
              year: 2017,
              price: 202540,
              carNumber: "AZJZ4",
              ownerId: "gNHjNFL12",
            },
            {
              name: "Corolla",
              year: 1996,
              price: 5420,
              carNumber: "kHE8f",
              ownerId: "gNHjNFL12",
            },
            {
              name: "Corolla",
              year: 2012,
              price: 40570,
              carNumber: "p2qEi",
              ownerId: "gNHjNFL12",
            },
          ],
        },
        {
          brand: "Ford",
          models: [
            {
              name: "Explorer",
              year: 2014,
              price: 127502,
              carNumber: "Ty1zN",
              ownerId: "gNHjNFL12",
            },
            {
              name: "F350",
              year: 2012,
              price: 54250,
              carNumber: "z03H2",
              ownerId: "gNHjNFL12",
            },
          ],
        },
        {
          brand: "Chevrolet",
          models: [
            {
              name: "Savannah",
              year: 2010,
              price: 36504,
              carNumber: "RXFZe",
              ownerId: "gNHjNFL12",
            },
            {
              name: "Malibu",
              year: 2009,
              price: 19585,
              carNumber: "K5IsM",
              ownerId: "gNHjNFL12",
            },
          ],
        },
      ],
    },
    {
      agencyName: "Car Werks",
      cash: 302502,
      credit: 150000,
      agencyId: "9KeaYbRLP",
      cars: [
        {
          brand: "bmw",
          models: [
            {
              name: "8",
              year: 2020,
              price: 942500,
              carNumber: "4IUMz",
              ownerId: "9KeaYbRLP",
            },
            {
              name: "X6",
              year: 2010,
              price: 129000,
              carNumber: "Vw0fV",
              ownerId: "9KeaYbRLP",
            },
            {
              name: "X3",
              year: 2019,
              price: 358100,
              carNumber: "ufN54",
              ownerId: "9KeaYbRLP",
            },
            {
              name: "3",
              year: 2020,
              price: 389100,
              carNumber: "F127X",
              ownerId: "9KeaYbRLP",
            },
            {
              name: "3",
              year: 2002,
              price: 18400,
              carNumber: "ueZUp",
              ownerId: "9KeaYbRLP",
            },
          ],
        },
        {
          brand: "toyota",
          models: [
            {
              name: "Prius",
              year: 2011,
              price: 38520,
              carNumber: "AZJZ4",
              ownerId: "9KeaYbRLP",
            },
            {
              name: "Land Cruiser",
              year: 2019,
              price: 290040,
              carNumber: "AZJZ4",
              ownerId: "9KeaYbRLP",
            },
            {
              name: "Hilux",
              year: 2020,
              price: 215700,
              carNumber: "xig8N",
              ownerId: "9KeaYbRLP",
            },
            {
              name: "Hilux",
              year: 2015,
              price: 178506,
              carNumber: "ghTiQ",
              ownerId: "9KeaYbRLP",
            },
            {
              name: "Corolla",
              year: 2002,
              price: 8504,
              carNumber: "Mvw8T",
              ownerId: "9KeaYbRLP",
            },
          ],
        },
        {
          brand: "Chevrolet",
          models: [
            {
              name: "Impala",
              year: 2005,
              price: 9320,
              carNumber: "BZpkt",
              ownerId: "9KeaYbRLP",
            },
            {
              name: "Malibu",
              year: 2002,
              price: 4502,
              carNumber: "KqKV_",
              ownerId: "9KeaYbRLP",
            },
          ],
        },
      ],
    },
    {
      agencyName: "Carsova",
      cash: 72450,
      credit: 50000,
      agencyId: "oqQmsZoUo",
      cars: [
        {
          brand: "bmw",
          models: [
            {
              name: "7",
              year: 1999,
              price: 24700,
              carNumber: "sZrjp",
              ownerId: "oqQmsZoUo",
            },
            {
              name: "3",
              year: 2008,
              price: 54000,
              carNumber: "da88K",
              ownerId: "oqQmsZoUo",
            },
          ],
        },
        {
          brand: "toyota",
          models: [
            {
              name: "Prius",
              year: 2019,
              price: 124050,
              carNumber: "ZfbqH",
              ownerId: "oqQmsZoUo",
            },
            {
              name: "Hilux",
              year: 1996,
              price: 11540,
              carNumber: "AZJZ4",
              ownerId: "oqQmsZoUo",
            },
          ],
        },
      ],
    },
  ],
  customers: [
    {
      name: "Lilah Goulding",
      id: "BGzHhjnE8",
      cars: [
        {
          name: "Corolla",
          year: 2013,
          price: 40570,
          carNumber: "16da1",
          ownerId: "BGzHhjnE8",
        },
      ],
      cash: 35000,
    },
    {
      name: "Ravi Murillo",
      id: "2RprZ1dbL",
      cars: [
        {
          name: "M5",
          year: 2019,
          price: 578054,
          carNumber: "WIh0U",
          ownerId: "2RprZ1dbL",
        },
        {
          name: "Spider",
          year: 2012,
          price: 81520,
          carNumber: "RLS4q",
          ownerId: "2RprZ1dbL",
        },
      ],
      cash: 278542,
    },
    {
      name: "Aleksander Carr",
      id: "pAuFtn_WA",
      cars: [
        {
          name: "Highlander",
          year: 2018,
          price: 214503,
          carNumber: "2WU_y",
          ownerId: "pAuFtn_WA",
        },
      ],
      cash: 125402,
    },
    {
      name: "Lana Edge",
      id: "cnTobUDy6",
      cars: [
        {
          name: "F250",
          year: 2020,
          price: 198500,
          carNumber: "Xxcy_",
          ownerId: "cnTobUDy6",
        },
        {
          name: "Hilux",
          year: 2005,
          price: 35005,
          carNumber: "VSCUj",
          ownerId: "cnTobUDy6",
        },
      ],
      cash: 7000,
    },
    {
      name: "Nikita Philip",
      id: "5x2tMcX4R",
      cars: [
        {
          name: "Impala",
          year: 2016,
          price: 65042,
          carNumber: "LKInp",
          ownerId: "5x2tMcX4R",
        },
      ],
      cash: 40541,
    },
    {
      name: "Bob Steel",
      id: "Wm6BkA1F0",
      cars: [],
      cash: 15732,
    },
    {
      name: "Will Reyes",
      id: "FQvNsEwLZ",
      cars: [
        { name: "X6", year: 2020, price: 966500, ownerId: "FQvNsEwLZ" },
        {
          name: "Land Cruiser",
          year: 2020,
          price: 336300,
          carNumber: "vaJvd",
          ownerId: "FQvNsEwLZ",
        },
        {
          name: "Romeo Julia",
          year: 2020,
          price: 275406,
          carNumber: "qLoYR",
          ownerId: "FQvNsEwLZ",
        },
        {
          name: "Explorer",
          year: 2020,
          price: 265200,
          carNumber: "tlGRq",
          ownerId: "FQvNsEwLZ",
        },
      ],
      cash: 1547242,
    },
  ],
  taxesAuthority: {
    totalTaxesPaid: 0,
    sumOfAllTransactions: 0,
    numberOfTransactions: 0,
  },
};
//! agency's func's
//todo getters

//* getAgencyByName
//? @param {string} - name
//? @return {Object} - agency object
carMarket.getAgencyByName = function (name) {
  const agencyfindByname = this.sellers.find(
    (agencyN) => agencyN.agencyName === name
  );
  return agencyfindByname;
};

// console.log(carMarket.getAgencyByName("CarMax"));

//* getAgencyIdByName
//? @param {String} - name
//? @return {String} - agencyId
carMarket.getAgencyIdByName = function (name) {
  const agencyfindById = this.sellers.find(
    (agencyN) => agencyN.agencyName === name
  );
  return agencyfindById ? agencyfindById.agencyId : undefined;
};

// console.log(carMarket.getAgencyIdByName("Best Deal"));

//* getAllAgenciesName
//? @param {}
//? @return {string[]} - agenciesNameArr - Array of all agencies name

carMarket.getAllAgenciesName = function () {
  const agencysByNameArr = this.sellers.map((agencyN) => agencyN.agencyName);
  return agencysByNameArr;
};

// console.log(carMarket.getAllAgenciesName());

//* getAllCarToBuy
//? @param {}
//? @return {object[]} - allCarsToBuy - arrays of all cars objects

carMarket.getAllCarToBuy = function () {
  const AllCarToBuy = this.sellers.map((agencyN) => agencyN.cars);
  return AllCarToBuy;
};

// console.log(carMarket.getAllCarToBuy());

//* getAllCarToBuyByAgencyId
//? @param {string} - id of agency
//? @return {object[]} - carsArray - arrays of all models objects of specific agency

carMarket.getAllCarToBuyByAgencyId = function (id) {
  const AllCarToBuyByAgencyId = this.sellers
    .find((agencyN) => agencyN.agencyId === id)
    .cars.map((mod) => mod.models);
  return AllCarToBuyByAgencyId;
};

// console.log(carMarket.getAllCarToBuyByAgencyId("Plyq5M5AZ"));

//* getAllBrandsToBuyAgencyId
//? @param {string} - agencyId -  id of agency
// ? @return {string[]} - arrOfBrands - arrays of all brands name in specific agency

carMarket.getAllBrandsToBuyAgencyId = function (id) {
  const AllBrandsToBuyAgencyId = this.sellers
    .find((agencyN) => agencyN.agencyId === id)
    .cars.map((brandName) => brandName["brand"]);
  return AllBrandsToBuyAgencyId;
};

// console.log(carMarket.getAllBrandsToBuyAgencyId("Plyq5M5AZ"));

//! customer func's
//todo getters
//* getCustomerByName
//? @param {string} - name
//? @return {Object} - customer

carMarket.getCustomerByName = function (name) {
  const customerByName = this.customers.find(
    (custName) => custName.name === name
  );
  return customerByName;
};

// console.log(carMarket.getCustomerByName("Aleksander Carr"));

//* getCustomerIdByName
//? @param {name}
//? @return {String} - customerId - The customer id

carMarket.getCustomerIdByName = function (name) {
  const customerIdByName = this.customers.find(
    (custId) => custId.name === name
  );
  return customerIdByName.id;
};

// console.log(carMarket.getCustomerIdByName("Lana Edge"));

//* getAllCustomersNames
//? @param {}
//? @return {string[]} - customersNameArr -  Array of all customers name
carMarket.getAllCustomersNames = function () {
  const allCustomersNames = this.customers.map((custName) => custName.name);
  return allCustomersNames;
};

// console.log(carMarket.getAllCustomersNames());

//* getAllCustomerCars
//? @param {id} - costumerId - costumer id
//? @return {object[]} - customerCarsArr -  Array of all customer cars object

carMarket.getAllCustomerCars = function (id) {
  const allCustomerCars = this.customers
    .find((custId) => custId.id === id)
    .cars.map((custCars) => custCars);
  return allCustomerCars;
};

// console.log(carMarket.getAllCustomerCars("cnTobUDy6"));

//* getCustomerCash
//? @param {id} - costumerId - costumer id
//? @return {number} - CustomerCash

carMarket.getCustomerCash = function (id) {
  const customerCash = this.customers.find((custId) => custId.id === id).cash;
  // .keys((custCash) => custCash.cash);
  return customerCash;
};

// console.log(carMarket.getCustomerCash("5x2tMcX4R"));
// /!------------------------------------------------------------

//*  1) setPropertyBrandToAllCars
//? set all cars model object the current brand
//? @param {}
//? @return {}

carMarket.setPropertyBrandToAllCars = function () {
  const sellerAllCars = this.sellers.map((carsObj) =>
    carsObj.cars.map((sellerCarObj) => sellerCarObj)
  );

  let customerAllCars = this.customers.map((custCar) =>
    custCar.cars.map((custCarObj) => custCarObj)
  );

  customerAllCars.forEach((custCars) => {
    for (let sellerCarObj of sellerAllCars) {
      for (let sellerCarModul of sellerCarObj) {
        for (let custCar of custCars) {
          for (let i = 0; i < sellerCarModul.models.length; i++) {
            if (custCar.name === sellerCarModul.models[i].name)
              custCar["brand"] = sellerCarModul.brand;
          }
        }
      }
    }
  });

  return customerAllCars;
};

carMarket.setPropertyBrandToAllCars();
// console.log(carMarket.customers);

//todo Agency setters
//* setNewCarToAgency
//? @param {string} - id of agency
//? @param {object} - carObject
//? @return {}

carMarket.setNewCarToAgency = function (id, carObject) {
  let wasPush = false;
  let agencyIdAllCars = this.sellers.find(
    (agencyN) => agencyN.agencyId === id
  ).cars;

  carObject.models[0].ownerId = id;
  for (let carObj of agencyIdAllCars) {
    if (carObject.brand === carObj.brand && !wasPush) {
      for (let i = 0; i < carObject.models.length; i++) {
        carObj.models.push(carObject.models[i]);
      }
      wasPush = true;
    }
  }
  if (!wasPush) agencyIdAllCars.push(carObject);
};

/////
const newCar = {
  brand: "Fiat",
  models: [
    {
      name: "Punto",
      year: 2020,
      price: 100000,
      carNumber: "5Tvc8",
    },
  ],
};

carMarket.setNewCarToAgency("26_IPfHU1", newCar);
// console.log(carMarket.sellers);

//* deleteCarFromAgency
//? @param {string} - id of agency
//? @param {string} -  Car id
// ? @return {}

carMarket.deleteCarFromAgency = function (agencyId, carId) {
  let delCarFromAgency = this.sellers
    .find((agencyN) => agencyN.agencyId === agencyId)
    .cars.map((agencyCars) =>
      agencyCars.models.filter((carNum) => carNum.carNumber !== carId)
    );

  // for (let carObj of delCarFromAgency) {
  //   carObj.forEach((carModel) => carModel.models.map());

  //   if (carId === carObj.models["carNumber"]) {
  //     console.log("yes");
  //     // for (let i = 0; i < carObject.models.length; i++) {
  //     //   carObj.models.push(carObject.models[i]);
  //   }
  //   // wasPush = true;
  //   // }
  // }
  // console.log(delCarFromAgency);
};

carMarket.deleteCarFromAgency("26_IPfHU1", "kAnv-");
// console.log(carMarket.sellers);

//* decrementOrIncrementCashOfAgency
//? @param {string} - agencyId
//? @param {number} - amount - negative or positive amount
// ? @return {number} - agencyCash

carMarket.decrementOrIncrementCashOfAgency = function (agencyId, amount) {
  const agencyCash = (this.sellers.find(
    (agencyN) => agencyN.agencyId === agencyId
  ).cash += amount);

  return agencyCash;
};

carMarket.decrementOrIncrementCashOfAgency("26_IPfHU1", -100000);
// console.log(carMarket.sellers);

//* decrementOrIncrementCreditOfAgency
//? @param {string} - agencyId
//? @param {number} - amount - negative or positive amount
// ? @return {number} - agencyCash

carMarket.decrementOrIncrementCreditOfAgency = function (agencyId, amount) {
  const agencyCash = (this.sellers.find(
    (agencyN) => agencyN.agencyId === agencyId
  ).credit += amount);

  return agencyCash;
};
carMarket.decrementOrIncrementCreditOfAgency("gNHjNFL12", 100000);
// console.log(carMarket.sellers);

//* setAmountOfCarsToBuyToAllAgency's
//? set a new property amountOfCars to all agency's, that represent the amount of cars available in the agency.
//? @param {}
// ? @return {objects[]} - sellers - array of all agency's

carMarket.setAmountOfCarsToBuyToAllAgencys = function () {
  const AmountOfCarsToBuyToAllAgencys = this.sellers.map(
    (amountOfCars) => (amountOfCars.amountOfCars = 65)
  );
};

carMarket.setAmountOfCarsToBuyToAllAgencys();
// console.log(carMarket.sellers);

//todo setters
//* setCarToCostumer
//? @param {string} - costumerId
//? @param {object} - carObject
//? @return {object[]} - allCarsOfCostumer

carMarket.setCarToCostumer = function (costumerId, carObject) {
  const allCarsOfCostumer = this.getAllCustomerCars(costumerId);

  allCarsOfCostumer.push(carObject);

  return allCarsOfCostumer;
};

const newCar1 = {
  name: "Focus",
  year: 2005,
  price: 6502,
  carNumber: "LJTCs",
  ownerId: "5x2tMcX4R",
};

carMarket.setCarToCostumer("5x2tMcX4R", newCar1);
// console.log(carMarket.customers);

//* deleteCarOfCostumer
//? @param {string} - costumerId
//? @param {string} - carId
//? @return {object[]} - allCarsOfCostumer

carMarket.deleteCarOfCostumer = function (costumerId, carId) {
  const customer = this.customers.find((custId) => custId.id === costumerId);

  const allCarsOfCostumer = this.customers
    .find((custId) => custId.id === costumerId)
    .cars.filter((carNum) => carNum.carNumber !== carId);
  console.log(allCarsOfCostumer);
  customer.cars = allCarsOfCostumer;
  return customer.cars;
};

carMarket.deleteCarOfCostumer("cnTobUDy6", "VSCUj");
console.log(carMarket.customers);

//* decrementOrIncrementCashOfCostumer
//? @param {string} - costumerId
//? @param {number} - amount - negative or positive amount
// ? @return {number} - costumerCash

carMarket.decrementOrIncrementCashOfCostumer = function (costumerId, amount) {
  const costumerCash = (this.customers.find(
    (custId) => custId.id === costumerId
  ).cash += amount);
};

carMarket.decrementOrIncrementCashOfCostumer("cnTobUDy6", 5000);
// console.log(carMarket.customers);
